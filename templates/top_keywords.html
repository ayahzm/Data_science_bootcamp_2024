{% extends "base_template.html" %}

{% block title %}Word Cloud{% endblock %}

{% block content %}

<div id="wordclouddiv" style="margin-left:500px; margin-top:100px; width: 50%; height: 500px;"></div>
{% endblock %}

{% block script %}
<script>
fetch('http://127.0.0.1:5000/top_keywords')
  .then(response => {
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    return response.json();
  })
  .then(data => {
    console.log("Fetched data:", data);
    createWordCloud(data);
  })
  .catch(error => {
    console.error("Error fetching data:", error);
  });

function createWordCloud(chartData) {
  var root = am5.Root.new("wordclouddiv");
  root.setThemes([am5themes_Animated.new(root)]);
  var series = root.container.children.push(am5wc.WordCloud.new(root, {
    categoryField: "keyword",
    valueField: "occurrences"
  }));
  series.data.setAll(chartData);
  series.appear(1000);
}
</script>
{% endblock %}
